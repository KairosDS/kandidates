<link rel="import" href="../../../bower_components/polymer/polymer.html"/>
<dom-module name="candidate-item">

  <style>
    /* General */
    :host {
      display: block;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 1px 1px rgba(0,0,0,.05);
      padding: 15px;
    }
    :host > div {
      display: inline-block;
      padding: 0;
    }

    /* Display in rows */
    :host.list {
      display: table-row;
      border-radius: 0;
      box-shadow: none;
      border: 0 solid black;
      border-top-width: 1px;
      border-bottom-width: 1px;
      padding: 3px;
    }
    :host.list:first-child {
      border-top-width: 0;
    }
    :host.list:last-child {
      border-bottom-width: 0;
    }
    :host.list > div {
      display: table-cell;
    }
    :host.list .extra {
      display: none;
    }

    /* Inner styling */
    .personal {
      font-weight: bold;
    }
    .personal .name {
      font-style: italic;
    }

    /* Status styling */
    .status-grayed {
      color: #777;
    }
    .status-oblique {
      font-style: italic;
    }
    .status-down {
      color: #3c763d;
      font-style: italic;
    }
    .status-info {
      color: #31708f;
    }
    .status-warn {
      color: #8a6d3b;
    }
    .status-good {
      color: #3c763d;
    }
  </style>

  <template>
    <div class="personal"><span class="surname">{{surname}}</span>, <span class="name">{{name}}</span></div>
    <div class="years"><span>{{years}}</span></div>
    <div class="status"><span>{{makeStatus(status)}}</span></div>
    <div class="category">{{category}}</div>
    <div class="extra"><content></content></div>
  </template>

  <script type="text/javascript">
    var getStatus = function (status) {
      if(status < statusCodes.length)
        return statusCodes[status];
      throw Error('invalid status code');
    };
    var stylize = function (ctx) {
      //List style
      if(ctx.list)
        $(ctx).addClass('list');

      //Status
      var currentStatus = getStatus(ctx.status), className;
      switch(currentStatus.cType) {
        case 'waiting':
        case 'meetingreq':
        case 'meetingsched':
          className = 'status-info';
          break;
        case 'moreinfo':
        case 'evaluating':
          className = 'status-warn';
          break;
        case 'signed':
        case 'accepted':
          className = 'status-good';
          break;
        case 'off':
          className = 'status-down';
          break;
        case 'notyet':
          className = 'status-grayed status-oblique';
          break;
        case 'nexttime':
        default:
          className = 'status-grayed';
          break;
      };
      $(ctx).find('.status').addClass(className);

    };
    var statusCodes = [
      {'cType': 'notyet', 'cValue': 'Not contacted'},
      {'cType': 'waiting', 'cValue': 'Waiting for reply'},
      {'cType': 'moreinfo', 'cValue': 'Wants more info'},
      {'cType': 'meetingreq', 'cValue': 'Meeting requested'},
      {'cType': 'meetingsched', 'cValue': 'Meeting scheduled'},
      {'cType': 'evaluating', 'cValue': 'Evaluating'},
      {'cType': 'accepted', 'cValue': 'Accepted'},
      {'cType': 'signed', 'cValue': 'Signed'},
      {'cType': 'nexttime', 'cValue': 'Wait some time'},
      {'cType': 'off', 'cValue': 'Discarded'}
    ];

    Polyitem = Polymer({
      is: 'candidate-item',
      properties: {
        surname: {
          type: String,
          value: 'Surame'
        },
        name: {
          type: String,
          value: 'Name'
        },
        years: {
          type: Number,
          value: 1
        },
        status: {
          type: Number,
          value: 0
        },
        category: {
          type: String,
          value: 'Catg'
        },
        list: {
          type: Boolean,
          value: false
        }
      },
      attached: function () {
        stylize(this);
      },
      makeStatus: function (status) {
        return getStatus(status).cValue;
      }
    });
    var polyitem = new Polyitem();
  </script>

</dom-module>